import{t as I,a as D,c as ut}from"../chunks/BYnF3rOy.js";import{E as et,w as u,K as $,F as r,G as t,H as o,g as a,I as N,J as at,a4 as Et,M as _t,v as Y}from"../chunks/Crv4zYnq.js";import{d as mt,s as l}from"../chunks/Dm_fk7OU.js";import{i as W,s as st,a as ot}from"../chunks/ClnFDjlp.js";import{s as rt,$ as nt,e as ft,i as ht,w as It}from"../chunks/BaVWbI2G.js";import{p as pt}from"../chunks/BX-zPlPB.js";import{o as it}from"../chunks/BbPrzgj8.js";import{s as bt,c as xt}from"../chunks/Dx-BRyeI.js";var Pt=(B,c)=>u(c,!a(c)),Rt=I('<div class="p-4 rounded-xl border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800"><p class="mb-1"><strong> </strong> </p> <p class="mb-1"><strong> </strong> </p> <img alt="Tire" class="w-16 h-16 mb-2"> <p class="mb-1"><strong> </strong> </p></div>'),Bt=I('<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>'),Ft=I('<div class="mb-6"><button type="button" class="flex justify-between items-center w-full cursor-pointer bg-transparent border-0 p-0 focus:outline-none"><h2 class="text-xl font-semibold text-left"> </h2> <img alt="Toggle" class="w-12 h-12 transition-transform duration-200"></button> <!></div>');function Nt(B,c){et(c,!0);const[Q,U]=ot(),_=()=>st(nt,"$t",Q);let F=pt(c,"stints",19,()=>[]),T=pt(c,"pitStops",19,()=>[]),j=$(!0),h=$(!1);it(()=>{const n=window.matchMedia("(prefers-color-scheme: dark)");u(h,n.matches,!0),n.addEventListener("change",d=>u(h,d.matches,!0))});var S=Ft(),f=r(S);f.__click=[Pt,j];var M=r(f),J=r(M,!0);t(M);var K=o(M,2);t(f);var q=o(f,2);{var m=n=>{var d=Bt();ft(d,21,F,b=>b.driver_number,(b,g)=>{var C=Rt(),A=r(C),P=r(A),G=r(P);t(P);var z=o(P);t(A);var s=o(A,2),v=r(s),e=r(v);t(v);var i=o(v);t(s);var p=o(s,2),x=o(p,2),w=r(x),R=r(w);t(w);var L=o(w);t(x),t(C),N((y,k,V,E,H,O)=>{l(G,`${y??""}:`),l(z,` ${a(g).driver_number??""} (${k??""})`),l(e,`${V??""}:`),l(i,` ${a(g).compound??""}`),rt(p,"src",E),l(R,`${H??""}:`),l(L,` ${O??""}`)},[()=>_()("driver"),()=>c.getDriverCode(a(g).driver_number),()=>_()("currentTire"),()=>`/tyres/${a(g).compound.toLowerCase()}.svg`,()=>_()("pitStops"),()=>T().filter(y=>y.driver_number===a(g).driver_number).length]),D(b,C)}),t(d),D(n,d)};W(q,n=>{a(j)&&n(m)})}t(S),N(n=>{l(J,n),rt(K,"src",a(j)?a(h)?"/arrow_up_white.svg":"/arrow_up.svg":a(h)?"/arrow_down_white.svg":"/arrow_down.svg")},[()=>_()("driverInfo")]),D(B,S),at(),U()}mt(["click"]);var Gt=(B,c)=>u(c,!a(c)),Ht=I('<tr><td class="p-2"> </td><td class="p-2 flex items-center gap-2"> <strong> </strong></td><td class="p-2"> </td><td class="p-2"> </td><td class="p-2"> </td><td class="p-2"> </td><td class="p-2"> </td></tr>'),Jt=I('<div class="overflow-x-auto"><table class="w-full text-sm border border-gray-300 dark:border-gray-700 rounded"><thead class="bg-gray-100 dark:bg-gray-800"><tr><th class="p-2 text-left"> </th><th class="p-2 text-left"> </th><th class="p-2 text-left"> </th><th class="p-2 text-left"> </th><th class="p-2 text-left"> </th><th class="p-2 text-left"> </th><th class="p-2 text-left">Total</th></tr></thead><tbody></tbody></table></div>'),Kt=I('<div class="mb-6"><button type="button" class="flex justify-between items-center w-full cursor-pointer bg-transparent border-0 p-0 focus:outline-none"><h2 class="text-xl font-semibold text-left"> </h2> <img alt="Toggle" class="w-12 h-12 transition-transform duration-200"></button> <!></div>');function qt(B,c){et(c,!0);const[Q,U]=ot(),_=()=>st(nt,"$t",Q);let F=pt(c,"lapTimes",19,()=>[]),T=$(!1),j=$(!0);it(()=>{const n=window.matchMedia("(prefers-color-scheme: dark)");u(T,n.matches,!0),n.addEventListener("change",d=>u(T,d.matches,!0))});function h(n){if(!n||isNaN(n))return"-";const d=Math.floor(n/60),b=(n%60).toFixed(3).padStart(6,"0");return d>0?`${d}:${b}`:b}var S=Kt(),f=r(S);f.__click=[Gt,j];var M=r(f),J=r(M,!0);t(M);var K=o(M,2);t(f);var q=o(f,2);{var m=n=>{var d=Jt(),b=r(d),g=r(b),C=r(g),A=r(C),P=r(A,!0);t(A);var G=o(A),z=r(G,!0);t(G);var s=o(G),v=r(s,!0);t(s);var e=o(s),i=r(e);t(e);var p=o(e),x=r(p);t(p);var w=o(p),R=r(w);t(w),Et(),t(C),t(g);var L=o(g);ft(L,21,()=>F().slice(-30),ht,(y,k,V)=>{var E=Ht();bt(E,1,xt(V%2===0?"bg-gray-50 dark:bg-gray-800":""));var H=r(E),O=r(H,!0);t(H);var X=o(H),Z=r(X),tt=o(Z),wt=r(tt,!0);t(tt),t(X);var lt=o(X),yt=r(lt,!0);t(lt);var vt=o(lt),kt=r(vt,!0);t(vt);var ct=o(vt),$t=r(ct,!0);t(ct);var dt=o(ct),St=r(dt,!0);t(dt);var gt=o(dt),Dt=r(gt,!0);t(gt),t(E),N((Tt,Lt,jt,Mt,Ct,At)=>{l(O,Tt),l(Z,`${a(k).driver_number??""} - `),l(wt,Lt),l(yt,a(k).lap_number),l(kt,jt),l($t,Mt),l(St,Ct),l(Dt,At)},[()=>c.getCurrentPosition(a(k).driver_number),()=>c.getDriverCode(a(k).driver_number),()=>h(a(k).duration_sector_1),()=>h(a(k).duration_sector_2),()=>h(a(k).duration_sector_3),()=>h(a(k).lap_duration)]),D(y,E)}),t(L),t(b),t(d),N((y,k,V,E,H,O)=>{l(P,y),l(z,k),l(v,V),l(i,`${E??""} 1`),l(x,`${H??""} 2`),l(R,`${O??""} 3`)},[()=>_()("position"),()=>_()("driver"),()=>_()("lap"),()=>_()("sector"),()=>_()("sector"),()=>_()("sector")]),D(n,d)};W(q,n=>{a(j)&&n(m)})}t(S),N(n=>{l(J,n),rt(K,"src",a(j)?a(T)?"/arrow_up_white.svg":"/arrow_up.svg":a(T)?"/arrow_down_white.svg":"/arrow_down.svg")},[()=>_()("lapTimes")]),D(B,S),at(),U()}mt(["click"]);var zt=(B,c)=>u(c,!a(c)),Ot=I('<tr><td class="p-2"> </td><td class="p-2"> </td><td class="p-2"> </td></tr>'),Qt=I('<div class="overflow-x-auto"><table class="w-full text-sm border border-gray-300 dark:border-gray-700 rounded"><thead class="bg-gray-100 dark:bg-gray-800"><tr><th class="p-2 text-left"> </th><th class="p-2 text-left"> </th><th class="p-2 text-left"> </th></tr></thead><tbody></tbody></table></div>'),Ut=I('<div class="mb-6"><button type="button" class="flex justify-between items-center w-full cursor-pointer bg-transparent border-0 p-0 focus:outline-none"><h2 class="text-xl font-semibold text-left"> </h2> <img alt="Toggle" class="w-12 h-12 transition-transform duration-200"></button> <!></div>');function Vt(B,c){et(c,!0);const[Q,U]=ot(),_=()=>st(nt,"$t",Q);let F=$(!0),T=$(!1);it(()=>{const m=window.matchMedia("(prefers-color-scheme: dark)");u(T,m.matches,!0),m.addEventListener("change",n=>u(T,n.matches,!0))});function j(m){if(!m||isNaN(m))return"-";const n=Math.floor(m/60),d=(m%60).toFixed(3).padStart(6,"0");return n>0?`${n}:${d}`:d}var h=Ut(),S=r(h);S.__click=[zt,F];var f=r(S),M=r(f,!0);t(f);var J=o(f,2);t(S);var K=o(S,2);{var q=m=>{var n=Qt(),d=r(n),b=r(d),g=r(b),C=r(g),A=r(C,!0);t(C);var P=o(C),G=r(P,!0);t(P);var z=o(P),s=r(z,!0);t(z),t(g),t(b);var v=o(b);ft(v,21,()=>c.pitStops,ht,(e,i,p)=>{var x=ut(),w=_t(x);{var R=L=>{var y=Ot();bt(y,1,xt(p%2===0?"bg-gray-50 dark:bg-gray-800":""));var k=r(y),V=r(k);t(k);var E=o(k),H=r(E,!0);t(E);var O=o(E),X=r(O,!0);t(O),t(y),N((Z,tt)=>{l(V,`${a(i).driver_number??""} (${Z??""})`),l(H,a(i).lap_number),l(X,tt)},[()=>c.getDriverCode(a(i).driver_number),()=>j(a(i).pit_duration)]),D(L,y)};W(w,L=>{a(i).lap_number!==1&&L(R)})}D(e,x)}),t(v),t(d),t(n),N((e,i,p)=>{l(A,e),l(G,i),l(s,p)},[()=>_()("driver"),()=>_()("lap"),()=>_()("pitStopDuration")]),D(m,n)};W(K,m=>{a(F)&&m(q)})}t(h),N(m=>{l(M,m),rt(J,"src",a(F)?a(T)?"/arrow_up_white.svg":"/arrow_up.svg":a(T)?"/arrow_down_white.svg":"/arrow_down.svg")},[()=>_()("pitStopDuration")]),D(B,h),at(),U()}mt(["click"]);var Wt=I('<section class="flex flex-col items-center justify-center min-h-[60vh] text-gray-700 dark:text-gray-300"><div class="animate-spin rounded-full h-12 w-12 border-4 border-t-transparent border-blue-600 mb-6"></div> <p class="text-xl font-semibold tracking-wide"> </p></section>'),Xt=I('<div class="border-2 border-gray-300 dark:border-gray-700 rounded-xl p-4 m-4 font-sans bg-white dark:bg-gray-900 text-black dark:text-white transition-colors"><div class="flex justify-between items-center mb-6"><h1 class="text-2xl font-bold">F1 Live Tracker</h1></div> <!> <hr> <!> <hr> <!></div>'),Yt=I('<section class="flex flex-col items-center justify-center min-h-[60vh] text-gray-700 dark:text-gray-300 text-center"><p class="text-2xl font-bold"> </p></section>');function ir(B,c){et(c,!0);const[Q,U]=ot(),_=()=>st(nt,"$t",Q);let F=$(Y([])),T=$(Y([])),j=$(Y([])),h=$(Y([])),S=$(!0),f=$(!1),M=$(!1),J=$(Y([])),K=$(null),q=$(null);function m(){const s=new Map;return[...a(j)].filter(e=>e.lap_duration).forEach(e=>{(!s.has(e.driver_number)||e.lap_number>s.get(e.driver_number).lap_number)&&s.set(e.driver_number,e)}),Array.from(s.values()).sort((e,i)=>g(e.driver_number)-g(i.driver_number))}async function n(){const v=await(await fetch("https://api.openf1.org/v1/sessions?session_key=latest")).json();if(v.length===0)return!1;const e=v[0],i=new Date,p=new Date(e.date_start);return u(f,p<=i),a(f)}async function d(){const[s,v,e,i,p]=await Promise.all([fetch("https://api.openf1.org/v1/drivers?session_key=latest"),fetch("https://api.openf1.org/v1/stints?session_key=latest"),fetch("https://api.openf1.org/v1/laps?session_key=latest"),fetch("https://api.openf1.org/v1/pit?session_key=latest"),fetch("https://api.openf1.org/v1/position?session_key=latest")]);u(F,await s.json(),!0),u(T,await v.json(),!0),u(j,await e.json(),!0),u(h,await i.json(),!0),u(J,await p.json(),!0),u(q,m(),!0),u(K,C(),!0)}function b(s){var v;return((v=a(F).find(e=>e.driver_number===s))==null?void 0:v.name_acronym)||""}function g(s){const v=a(J).filter(e=>e.driver_number===s);return v.length===0?"-":v.reduce((e,i)=>i.session_time>e.session_time?i:e).position}function C(){const s=new Map;for(const e of a(T)){const i=s.get(e.driver_number);(!i||e.lap_start>i.lap_start)&&s.set(e.driver_number,e)}return Array.from(s.values()).sort((e,i)=>{const p=parseInt(g(e.driver_number))||99,x=parseInt(g(i.driver_number))||99;return p-x})}it(async()=>{await It();const s=await n();if(u(f,s,!0),s){await d(),u(S,!1);const v=setInterval(d,1e4),e=window.matchMedia("(prefers-color-scheme: dark)");return u(M,e.matches,!0),e.addEventListener("change",i=>u(M,i.matches,!0)),()=>clearInterval(v)}});var A=ut(),P=_t(A);{var G=s=>{var v=Wt(),e=o(r(v),2),i=r(e,!0);t(e),t(v),N(p=>l(i,p),[()=>_()("loading")]),D(s,v)},z=s=>{var v=ut(),e=_t(v);{var i=x=>{var w=Xt(),R=o(r(w),2);qt(R,{get lapTimes(){return a(q)},getCurrentPosition:g,getDriverCode:b});var L=o(R,4);Vt(L,{get pitStops(){return a(h)},getDriverCode:b});var y=o(L,4);Nt(y,{get stints(){return a(K)},get pitStops(){return a(h)},getDriverCode:b}),t(w),D(x,w)},p=x=>{var w=Yt(),R=r(w),L=r(R,!0);t(R),t(w),N(y=>l(L,y),[()=>_()("noSession")]),D(x,w)};W(e,x=>{a(f)?x(i):x(p,!1)})}D(s,v)};W(P,s=>{a(S)?s(G):s(z,!1)})}D(B,A),at(),U()}export{ir as component};
